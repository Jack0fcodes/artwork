<script>
  const username = "jack0fcodes";
  const repo = "artwork";
  const imagesFolder = "images";
  const gallery = document.getElementById("gallery");

  async function fetchArtworks() {
    // Fetch image list from GitHub API
    const res = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${imagesFolder}`);
    const files = await res.json();

    // Fetch statuses from artworks.json
    const detailsRes = await fetch(`https://${username}.github.io/${repo}/artworks.json`);
    const details = await detailsRes.json();

    files.forEach(file => {
      if (file.type === "file" && /\.(jpg|jpeg|png|gif)$/i.test(file.name)) {
        // Get status from JSON (default to Available)
        const meta = details[file.name] || {};
        const status = meta.status || "Available";
        const paypal = meta.paypal || "";

        // Use filename (without extension) as title
        const title = file.name.replace(/\.[^/.]+$/, "");

        // Build card
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${file.download_url}" alt="${title}">
          <div class="title">${title}</div>
          <div class="status ${status.toLowerCase()}">${status}</div>
          ${status === "Available" && paypal ? `<a class="paypal-btn" href="${paypal}" target="_blank">PayPal</a>` : ""}
        `;
        gallery.appendChild(card);
      }
    });
  }

  fetchArtworks();
</script>
